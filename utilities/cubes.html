
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>The Cube approach &#8212; cascade 0.1.3 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../_static/design-tabs.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="A differentiable atmosphere" href="simple_atmosphere.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">cascade 0.1.3 documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    cascade
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../install.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api_reference.html">
   API reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../mod_cascade.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       cascade
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../generated/cascade.sim.html">
       cascade.sim
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../generated/cascade.outcome.html">
       cascade.outcome
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../generated/cascade.set_nthreads.html">
       cascade.set_nthreads
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../generated/cascade.get_nthreads.html">
       cascade.get_nthreads
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../generated/cascade.set_logger_level_trace.html">
       cascade.set_logger_level_trace
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../generated/cascade.set_logger_level_debug.html">
       cascade.set_logger_level_debug
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../generated/cascade.set_logger_level_info.html">
       cascade.set_logger_level_info
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../generated/cascade.set_logger_level_warn.html">
       cascade.set_logger_level_warn
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../generated/cascade.set_logger_level_err.html">
       cascade.set_logger_level_err
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../generated/cascade.set_logger_level_critical.html">
       cascade.set_logger_level_critical
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../mod_cascade_dynamics.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       cascade.dynamics
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../generated/cascade.dynamics.kepler.html">
       cascade.dynamics.kepler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../generated/cascade.dynamics.simple_earth.html">
       cascade.dynamics.simple_earth
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../generated/cascade.dynamics.mascon_asteroid.html">
       cascade.dynamics.mascon_asteroid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../generated/cascade.dynamics.mascon_asteroid_energy.html">
       cascade.dynamics.mascon_asteroid_energy
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../collision_algorithm.html">
   Collision Algorithm
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/quickstart.html">
   Quickstart
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/conjunctions.html">
   Conjunctions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/whitelists.html">
   Whitelists
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Examples:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../examples/20yearsofLEO_coll.html">
   20 years of LEO - (collisions)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../examples/oneweekofLEO_conj.html">
   One week of LEO - (conjunctions)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../examples/itokawa_cubesats.html">
   Swarming Itokawa with cubesats
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Utilities:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="leo_population.html">
   The current LEO population
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simple_atmosphere.html">
   A differentiable atmosphere
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   The
   <em>
    Cube
   </em>
   approach
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/esa/cascade/main?urlpath=lab/tree/doc/utilities/cubes.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/esa/cascade"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/esa/cascade/issues/new?title=Issue%20on%20page%20%2Futilities/cubes.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/utilities/cubes.ipynb.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-imports">
   Data imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-few-useful-functions-we-will-use">
   A few useful functions we will use
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-full-simulation-of-20-years-of-leo-evolution">
   The full simulation of 20 years of LEO evolution
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>The Cube approach</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-imports">
   Data imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-few-useful-functions-we-will-use">
   A few useful functions we will use
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-full-simulation-of-20-years-of-leo-evolution">
   The full simulation of 20 years of LEO evolution
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="the-cube-approach">
<h1>The <em>Cube</em> approach<a class="headerlink" href="#the-cube-approach" title="Permalink to this headline">#</a></h1>
<p>During the first decade of the new millenium computational tools became refined enough for scientists to conceive numerical simulations of the long term evolution of an orbital environment:</p>
<blockquote>
<div><p>“With the help of modern computers, it is now possible to perform numerical simulations of the orbital evolution of an N-body system. Therefore, there is a need for a collision model that can work with an orbital evolution simulation code to allow for source and sink terms of the objects involved as well as to utilize their updated orbital elements as they evolve in time. The “Cube” approach is designed to accomplish just that.” - Liou, J-C. “Collision activities in the future orbital debris environment.” Advances in Space Research 38.9 (2006): 2102-2106.</p>
</div></blockquote>
<p>The <em>Cube</em> approach mentioned in the above quote is based on the idea that if <span class="math notranslate nohighlight">\(P_{ij}\)</span> is a collision probability between orbiting object <span class="math notranslate nohighlight">\(i\)</span> and object <span class="math notranslate nohighlight">\(j\)</span>, then the total number of collisions <span class="math notranslate nohighlight">\(N_{tot}\)</span> between the two objects in a time interval where <span class="math notranslate nohighlight">\(P_{ij}\)</span> can be considered constant will be:</p>
<p><span class="math notranslate nohighlight">\(
N_{tot} = \int_{t_s}^{t_f} P_{ij} ds = [t_f - t_s] P_{ij}
\)</span></p>
<p>The formula above is formally exact and shifts the problem to that of finding such an averaged <span class="math notranslate nohighlight">\(P_{ij}\)</span> capturing the collisional dynamics. In the <em>Cube</em> approach this is obtained dividing the entire Cartesian space in cubes of dimension <span class="math notranslate nohighlight">\(L\)</span> and introducing the following two hypothesis:</p>
<ul class="simple">
<li><p>Two objects <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> have a non zero impact probability in <span class="math notranslate nohighlight">\([t_f - t_s]\)</span> if and only if they occupy the same cube at <span class="math notranslate nohighlight">\(t_s\)</span>.</p></li>
<li><p>When non-zero, the collision probability between the two object <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> is derived from the kinetic theory of gas applied to the cube.</p></li>
</ul>
<p>In the following we describe python code implementing this approach for a large orbital population. As usual, we start with some imports:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Core imports</span>
<span class="kn">import</span> <span class="nn">pykep</span> <span class="k">as</span> <span class="nn">pk</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pickle</span> <span class="k">as</span> <span class="nn">pkl</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="c1"># sgp4 imports</span>
<span class="kn">import</span> <span class="nn">sgp4</span>
<span class="kn">from</span> <span class="nn">sgp4.api</span> <span class="kn">import</span> <span class="n">Satrec</span><span class="p">,</span> <span class="n">SatrecArray</span>

<span class="c1"># Plotting</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<section id="data-imports">
<h2>Data imports<a class="headerlink" href="#data-imports" title="Permalink to this headline">#</a></h2>
<p>We will use, as satellite population, the current  tracked objects in Low Earth Orbit as prepared by the code described in <a class="reference internal" href="leo_population.html"><span class="doc std std-doc">The current LEO population</span></a>. At the end of that code a pickled file is created containing initial positions and velocities of the objects together with the satcat dictionary to identify them. Let us load that data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># r is in km and v in km/s</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data/leo_population.pk&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">to_satcat_index</span><span class="p">,</span><span class="n">satcat</span> <span class="o">=</span> <span class="n">pkl</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The object described by the entry <code class="docutils literal notranslate"><span class="pre">satcat[to_satcat_index[j]]</span></code> has initial position <code class="docutils literal notranslate"><span class="pre">r[j]</span></code> and initial velocity <code class="docutils literal notranslate"><span class="pre">v[j]</span></code>. Let us inspect one entry</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dictionary entry: &quot;</span><span class="p">,</span> <span class="n">satcat</span><span class="p">[</span><span class="n">to_satcat_index</span><span class="p">[</span><span class="mi">3685</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Position (km): &quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="mi">3685</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Velocity (km/s): &quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">3685</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dictionary entry:  {&#39;CCSDS_OMM_VERS&#39;: &#39;2.0&#39;, &#39;COMMENT&#39;: &#39;GENERATED VIA SPACE-TRACK.ORG API&#39;, &#39;CREATION_DATE&#39;: &#39;2022-02-03T04:23:25&#39;, &#39;ORIGINATOR&#39;: &#39;18 SPCS&#39;, &#39;OBJECT_NAME&#39;: &#39;SL-14 DEB&#39;, &#39;OBJECT_ID&#39;: &#39;1978-100F&#39;, &#39;CENTER_NAME&#39;: &#39;EARTH&#39;, &#39;REF_FRAME&#39;: &#39;TEME&#39;, &#39;TIME_SYSTEM&#39;: &#39;UTC&#39;, &#39;MEAN_ELEMENT_THEORY&#39;: &#39;SGP4&#39;, &#39;EPOCH&#39;: &#39;2022-02-02T22:42:05.237280&#39;, &#39;MEAN_MOTION&#39;: &#39;12.56769207&#39;, &#39;ECCENTRICITY&#39;: &#39;0.00286110&#39;, &#39;INCLINATION&#39;: &#39;82.3526&#39;, &#39;RA_OF_ASC_NODE&#39;: &#39;268.9057&#39;, &#39;ARG_OF_PERICENTER&#39;: &#39;297.9015&#39;, &#39;MEAN_ANOMALY&#39;: &#39;75.7071&#39;, &#39;EPHEMERIS_TYPE&#39;: &#39;0&#39;, &#39;CLASSIFICATION_TYPE&#39;: &#39;U&#39;, &#39;NORAD_CAT_ID&#39;: &#39;19133&#39;, &#39;ELEMENT_SET_NO&#39;: &#39;999&#39;, &#39;REV_AT_EPOCH&#39;: &#39;93528&#39;, &#39;BSTAR&#39;: &#39;0.02113600000000&#39;, &#39;MEAN_MOTION_DOT&#39;: &#39;0.00003527&#39;, &#39;MEAN_MOTION_DDOT&#39;: &#39;0.0000000000000&#39;, &#39;SEMIMAJOR_AXIS&#39;: &#39;7814.445&#39;, &#39;PERIOD&#39;: &#39;114.580&#39;, &#39;APOAPSIS&#39;: &#39;1458.668&#39;, &#39;PERIAPSIS&#39;: &#39;1413.952&#39;, &#39;OBJECT_TYPE&#39;: &#39;DEBRIS&#39;, &#39;RCS_SIZE&#39;: &#39;MEDIUM&#39;, &#39;COUNTRY_CODE&#39;: &#39;CIS&#39;, &#39;LAUNCH_DATE&#39;: &#39;1978-10-26&#39;, &#39;SITE&#39;: &#39;PKMTR&#39;, &#39;DECAY_DATE&#39;: None, &#39;FILE&#39;: &#39;3290513&#39;, &#39;GP_ID&#39;: &#39;195174860&#39;, &#39;TLE_LINE0&#39;: &#39;0 SL-14 DEB&#39;, &#39;TLE_LINE1&#39;: &#39;1 19133U 78100F   22033.94589395  .00003527  00000-0  21136-1 0  9996&#39;, &#39;TLE_LINE2&#39;: &#39;2 19133  82.3526 268.9057 0028611 297.9015  75.7071 12.56769207935282&#39;, &#39;RADIUS&#39;: 0.2631205051777122}
Position (km):  [2129.88342848 3695.71335128 6552.37467945]
Velocity (km/s):  [ 1.38399824  5.88779107 -3.78530589]
</pre></div>
</div>
</div>
</div>
</section>
<section id="a-few-useful-functions-we-will-use">
<h2>A few useful functions we will use<a class="headerlink" href="#a-few-useful-functions-we-will-use" title="Permalink to this headline">#</a></h2>
<p>The following function computes the orbital period via the vis-viva equation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">period</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the orbital period from the vis-viva equation</span>

<span class="sd">    Args:</span>
<span class="sd">        r (float): The radius (in L).</span>
<span class="sd">        v (float): The velocity (in L/T).</span>
<span class="sd">        mu (float): The gravitational parameter in L^3/T^2</span>

<span class="sd">    Returns:</span>
<span class="sd">        The orbital period (in T)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">En</span> <span class="o">=</span> <span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">/</span> <span class="n">r</span>
    <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu</span> <span class="o">/</span> <span class="n">En</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Hyperbola!!!&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</pre></div>
</div>
</div>
</div>
<p>The following function is a central part of the <em>Cube</em> approach. It takes <span class="math notranslate nohighlight">\(N\)</span> points and a linear dimension and returns all the points that occupy the same cube of side L.
In our implementation the cubes start from the origin. In other words, along the three dimensions, the cube vertices have coordinates <span class="math notranslate nohighlight">\([...,-L,0,L,...]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cubes</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">cube_dimension</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Divides the space in cubes of size cube_dimension and returns points within the same cube</span>

<span class="sd">    Args:</span>
<span class="sd">        def cubes(points, cube_dimension):</span>
<span class="sd"> (Nx3 np.array): The cartesian position of the satellites (in L).</span>
<span class="sd">        cube_dimension (float): The cube dimentsion (in L).</span>

<span class="sd">    Returns:</span>
<span class="sd">        a list containing lists of satelites idx occupying the same cube</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># init</span>
    <span class="n">retval</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cubes</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

    <span class="c1"># We compute the floored Cartesian coordinates identifying the bins.</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">points</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">/</span> <span class="n">cube_dimension</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="c1"># We fill the bins</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">xyz</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
        <span class="n">cubes</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">xyz</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="c1"># We find bins with more than one object</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cubes</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cubes</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">retval</span>
</pre></div>
</div>
</div>
</div>
<p>Note that the great advantage of the above preliminar collision detection is that it has a linear complexity in the number of particles.
This makes the <em>Cube</em> approach scale remarkably well as an n-body collision simulation. Lets time its performances in our specific case:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> cubes(r, 10)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>33.1 ms ± 178 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
</div>
</div>
<p>The following function computes the SGP4 propagation of selected catalogued objects over a fixed time grid.
This numerical propagation is here made using the vectorized version of the SGP4 propagator achieving great efficiency.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simulate_sgp4</span><span class="p">(</span><span class="n">indexes</span><span class="p">,</span> <span class="n">sim_time</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">time_interval</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">jd</span> <span class="o">=</span> <span class="n">pk</span><span class="o">.</span><span class="n">epoch_from_iso_string</span><span class="p">(</span><span class="s2">&quot;20220301T000000&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">jd</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes all satellites ephemerides on a time grid</span>

<span class="sd">    Args:</span>
<span class="sd">        indexes (list of pk.planets): The indexes in the satcat dictionary of the objects to propagate.</span>
<span class="sd">        sim_time (float): The total propagation time (in years).</span>
<span class="sd">        time_interval(float): The time resolution (in days).</span>
<span class="sd">        jd (float): the starting epoch in julian date.</span>

<span class="sd">    Returns:</span>
<span class="sd">        a list containing lists of idx identifying the object occupying the same cube</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># This list will contain all the sgp4 Satrec objects</span>
    <span class="n">satellite_l</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">:</span>
        <span class="n">l1</span> <span class="o">=</span> <span class="n">satcat</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s2">&quot;TLE_LINE1&quot;</span><span class="p">]</span>
        <span class="n">l2</span> <span class="o">=</span> <span class="n">satcat</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s2">&quot;TLE_LINE2&quot;</span><span class="p">]</span>
        <span class="n">satellite_l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Satrec</span><span class="o">.</span><span class="n">twoline2rv</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">))</span>
    <span class="c1"># Here we build the vectorized version allowing for speed</span>
    <span class="n">satellites</span> <span class="o">=</span> <span class="n">SatrecArray</span><span class="p">(</span><span class="n">satellite_l</span><span class="p">)</span>
    <span class="c1"># The Julian dates are from jd0 to 20 years after</span>
    <span class="n">jds</span> <span class="o">=</span> <span class="n">jd</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sim_time</span><span class="o">*</span><span class="mf">365.25</span><span class="o">/</span><span class="n">time_interval</span><span class="p">)</span><span class="o">*</span><span class="n">time_interval</span>
    <span class="n">frs</span> <span class="o">=</span> <span class="n">jds</span> <span class="o">*</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">satellites</span><span class="o">.</span><span class="n">sgp4</span><span class="p">(</span><span class="n">jds</span><span class="p">,</span> <span class="n">frs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-full-simulation-of-20-years-of-leo-evolution">
<h2>The full simulation of 20 years of LEO evolution<a class="headerlink" href="#the-full-simulation-of-20-years-of-leo-evolution" title="Permalink to this headline">#</a></h2>
<p>We are now ready to set up a simulation of the evolution of the LEO environment for the next 20 yars. In particular we will be only detecting collisions.
We start precomputing all the positions and velocities of the orbiting objects in 20 years at a 5 day resolution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">err</span><span class="p">,</span><span class="n">r_sgp4</span><span class="p">,</span><span class="n">v_sgp4</span> <span class="o">=</span> <span class="n">simulate_sgp4</span><span class="p">(</span><span class="n">to_satcat_index</span><span class="p">,</span> <span class="n">sim_time</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">time_interval</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">jd</span> <span class="o">=</span> <span class="n">pk</span><span class="o">.</span><span class="n">epoch_from_iso_string</span><span class="p">(</span><span class="s2">&quot;20220301T000000&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">jd</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time to perform all numerical integrations: &quot;</span><span class="p">,</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Time to perform all numerical integrations:  19.566089153289795
</pre></div>
</div>
</div>
</div>
<p>We now perfrom the simulation and use within each time interval, the kinetic theory of gasses to determine whether a collision has happened or not.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">undecayed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">r_sgp4</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">n_collisions</span><span class="o">=</span><span class="mi">0</span>
<span class="n">N_tot</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_sgp4</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">Lcube</span> <span class="o">=</span> <span class="mf">10.</span> <span class="c1">#km</span>
    <span class="n">time_grid</span>  <span class="o">=</span> <span class="mi">5</span> <span class="c1">#days</span>
    <span class="c1"># If signalled from the sgp4, we remove the indices of the decayed satellites</span>
    <span class="n">decayed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">err</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">undecayed</span> <span class="o">=</span> <span class="n">undecayed</span> <span class="o">-</span> <span class="n">decayed</span>
    <span class="n">undecayed_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">undecayed</span><span class="p">])</span>
    <span class="c1"># We detect all satellites couples in the same cube of Lcube km size</span>
    <span class="n">collision</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">(</span><span class="n">r_sgp4</span><span class="p">[</span><span class="n">undecayed_l</span><span class="p">,</span><span class="n">i</span><span class="p">,:],</span> <span class="n">cube_dimension</span> <span class="o">=</span> <span class="n">Lcube</span><span class="p">)</span>
    <span class="c1">#kdt = KDTree(r[undecayed_l,i,:])</span>
    <span class="c1">#collision = list(kdt.query_pairs(Lcube))</span>
    <span class="c1">#print(collision)</span>
    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">collision</span><span class="p">:</span>
        <span class="c1"># we get the indexes in r,v</span>
        <span class="n">idx1</span> <span class="o">=</span> <span class="n">undecayed_l</span><span class="p">[</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">idx2</span> <span class="o">=</span> <span class="n">undecayed_l</span><span class="p">[</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="c1"># we store positions and velocities from r,v</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="n">r_sgp4</span><span class="p">[</span><span class="n">idx1</span><span class="p">,</span><span class="n">i</span><span class="p">,:]</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">r_sgp4</span><span class="p">[</span><span class="n">idx2</span><span class="p">,</span><span class="n">i</span><span class="p">,:]</span>
        <span class="n">v1</span> <span class="o">=</span> <span class="n">v_sgp4</span><span class="p">[</span><span class="n">idx1</span><span class="p">,</span><span class="n">i</span><span class="p">,:]</span>
        <span class="n">v2</span> <span class="o">=</span> <span class="n">v_sgp4</span><span class="p">[</span><span class="n">idx2</span><span class="p">,</span><span class="n">i</span><span class="p">,:]</span>
        <span class="c1"># we get the collision radiu from debris (indexed differently hence to_satcat is used)</span>
        <span class="n">radius1</span> <span class="o">=</span> <span class="n">satcat</span><span class="p">[</span><span class="n">to_satcat_index</span><span class="p">[</span><span class="n">idx1</span><span class="p">]][</span><span class="s2">&quot;RADIUS&quot;</span><span class="p">]</span>
        <span class="n">radius2</span> <span class="o">=</span> <span class="n">satcat</span><span class="p">[</span><span class="n">to_satcat_index</span><span class="p">[</span><span class="n">idx2</span><span class="p">]][</span><span class="s2">&quot;RADIUS&quot;</span><span class="p">]</span>
        <span class="c1"># Relative velocity </span>
        <span class="n">Vrel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v1</span><span class="o">-</span><span class="n">v2</span><span class="p">)</span>
        <span class="c1"># Collisional area of the couple (in km^2)</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">((</span><span class="n">radius1</span><span class="o">+</span><span class="n">radius2</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> 
        <span class="c1"># Volume of the cube (km^3)</span>
        <span class="n">U</span> <span class="o">=</span> <span class="p">(</span><span class="n">Lcube</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
        <span class="c1"># We compute the spatial densities</span>
        <span class="c1"># densities (from &quot;Assessing collision algorithms for the newspace era&quot; )</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">U</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">U</span>
        <span class="c1"># collision probability</span>
        <span class="n">Pij</span> <span class="o">=</span> <span class="n">s1</span><span class="o">*</span><span class="n">s2</span><span class="o">*</span><span class="n">Vrel</span><span class="o">*</span><span class="n">sigma</span><span class="o">*</span><span class="n">U</span><span class="o">*</span><span class="n">time_grid</span><span class="o">*</span><span class="n">pk</span><span class="o">.</span><span class="n">DAY2SEC</span>
        <span class="n">N_tot</span> <span class="o">+=</span> <span class="n">Pij</span>
        <span class="c1"># Store</span>
        <span class="k">if</span> <span class="n">Pij</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Collision! pair: </span><span class="si">{</span><span class="n">pair</span><span class="si">}</span><span class="s2">, years: </span><span class="si">{</span><span class="n">i</span><span class="o">*</span><span class="mi">5</span><span class="o">/</span><span class="mf">365.25</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">n_collisions</span><span class="o">+=</span><span class="mi">1</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time elasped: &quot;</span><span class="p">,</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Decayed objects: &quot;</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">undecayed</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of collisions: &quot;</span><span class="p">,</span> <span class="n">n_collisions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Expected number of collisions: &quot;</span><span class="p">,</span> <span class="n">N_tot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collision! pair: [14084, 14352], years: 0.6844626967830253
Collision! pair: [8170, 13942], years: 1.7659137577002053
Collision! pair: [12625, 18100], years: 1.943874058863792
Collision! pair: [13644, 15509], years: 2.6694045174537986
Collision! pair: [13059, 15181], years: 6.1738535249828885
Collision! pair: [13322, 14410], years: 9.267624914442163
Collision! pair: [1012, 11892], years: 10.581793292265571
Collision! pair: [4762, 4984], years: 16.632443531827516
Collision! pair: [1671, 5447], years: 16.79671457905544
Time elasped:  67.86483788490295
Decayed objects:  4990
Number of collisions:  9
Expected number of collisions:  11.538803066221181
</pre></div>
</div>
</div>
</div>
<p>Repeating the above code will give different results as we added noise to the initial conditions and the collision probabilities are checked rolling a dice.</p>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="simple_atmosphere.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">A differentiable atmosphere</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Francesco Biscani and Dario Izzo<br/>
  
      &copy; Copyright 2023, Francesco Biscani and Dario Izzo.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>