
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Collision Algorithm &#8212; cascade 0.1.6 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="_static/design-tabs.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Quickstart" href="tutorials/quickstart.html" />
    <link rel="prev" title="cascade.dynamics.mascon_asteroid_energy" href="generated/cascade.dynamics.mascon_asteroid_energy.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">cascade 0.1.6 documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    cascade
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="install.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="api_reference.html">
   API reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="mod_cascade.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       cascade
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="generated/cascade.sim.html">
       cascade.sim
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="generated/cascade.outcome.html">
       cascade.outcome
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="generated/cascade.set_nthreads.html">
       cascade.set_nthreads
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="generated/cascade.get_nthreads.html">
       cascade.get_nthreads
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="generated/cascade.set_logger_level_trace.html">
       cascade.set_logger_level_trace
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="generated/cascade.set_logger_level_debug.html">
       cascade.set_logger_level_debug
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="generated/cascade.set_logger_level_info.html">
       cascade.set_logger_level_info
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="generated/cascade.set_logger_level_warn.html">
       cascade.set_logger_level_warn
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="generated/cascade.set_logger_level_err.html">
       cascade.set_logger_level_err
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="generated/cascade.set_logger_level_critical.html">
       cascade.set_logger_level_critical
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="mod_cascade_dynamics.html">
     <code class="xref py py-mod docutils literal notranslate">
      <span class="pre">
       cascade.dynamics
      </span>
     </code>
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="generated/cascade.dynamics.kepler.html">
       cascade.dynamics.kepler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="generated/cascade.dynamics.simple_earth.html">
       cascade.dynamics.simple_earth
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="generated/cascade.dynamics.mascon_asteroid.html">
       cascade.dynamics.mascon_asteroid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="generated/cascade.dynamics.mascon_asteroid_energy.html">
       cascade.dynamics.mascon_asteroid_energy
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Collision Algorithm
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="tutorials/quickstart.html">
   Quickstart
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tutorials/conjunctions.html">
   Conjunctions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tutorials/whitelists.html">
   Whitelists
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Examples:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="examples/20yearsofLEO_coll.html">
   20 years of LEO - (collisions)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="examples/oneweekofLEO_conj.html">
   One week of LEO - (conjunctions)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="examples/itokawa_cubesats.html">
   Swarming Itokawa with cubesats
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Utilities:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="utilities/leo_population.html">
   The current LEO population
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="utilities/simple_atmosphere.html">
   A differentiable atmosphere
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="utilities/cubes.html">
   The
   <em>
    Cube
   </em>
   approach
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/esa/cascade"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/esa/cascade/issues/new?title=Issue%20on%20page%20%2Fcollision_algorithm.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/collision_algorithm.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Collision Algorithm
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#broad-phase">
   Broad Phase
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#narrow-phase">
   Narrow Phase
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parallelism">
   Parallelism
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Collision Algorithm</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Collision Algorithm
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#broad-phase">
   Broad Phase
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#narrow-phase">
   Narrow Phase
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parallelism">
   Parallelism
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="collision-algorithm">
<span id="id1"></span><h1>Collision Algorithm<a class="headerlink" href="#collision-algorithm" title="Permalink to this headline">#</a></h1>
<p>The collision algorithm in cascade exploits the availability, at each step, of Taylor polynomial expansions
of the system dynamics. These are a product of the Taylor integration scheme chosen to propagate the dynamics
and are provided at no additional cost (<a class="reference external" href="https://bluescarni.github.io/heyoka/">heyoka</a> API
allows for an easy extraction of such coefficients).</p>
<p>The following expressions are thus available:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
  x_i\left( \tau \right) &amp; = \sum_{n=0}^p x_i^{\left[ n \right]}\left( t_0 \right)\tau^n,\\
  y_i\left( \tau \right) &amp; = \sum_{n=0}^p y_i^{\left[ n \right]}\left( t_0 \right)\tau^n,\\
  z_i\left( \tau \right) &amp; = \sum_{n=0}^p z_i^{\left[ n \right]}\left( t_0 \right)\tau^n,\\
  r_i\left( \tau \right) &amp; = \sum_{n=0}^p r_i^{\left[ n \right]}\left( t_0 \right)\tau^n,
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau \in \left[0, c_t\right]\)</span> is a time coordinate within the so called collisional
timestep <span class="math notranslate nohighlight">\(c_t\)</span>, a user defined parameter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To be precise, these expressions are piecewise
continuous polynomials since the collisional timestep may be different from the adaptive
timestep of the Taylor integrator <span class="math notranslate nohighlight">\(h\)</span>. For the purpose of understanding the main algorithmic
ideas, this is here ignored.</p>
</div>
<p>cascade makes use of these expressions to compute <a class="reference external" href="https://en.wikipedia.org/wiki/Bounding_volume">Axis Aligned Bounding boxes (AABB)</a>
encapsulating the positions of each orbiting objects within the collisional timestep.
This is done using <a class="reference external" href="https://en.wikipedia.org/wiki/Interval_arithmetic">interval arithmetic</a> to compute the polynomial expressions
above and considering that <span class="math notranslate nohighlight">\(\tau \in \left[0, c_t\right]\)</span>. If the bounding boxes do not overlap, clearly
there will be no possible collision.</p>
</section>
<section id="broad-phase">
<h1>Broad Phase<a class="headerlink" href="#broad-phase" title="Permalink to this headline">#</a></h1>
<p>The detection of overlaps between bounding boxes is a well-studied problem in computer graphics
(where it is usually referred to as “broad phase collision detection”).
In particular, several spatial data structures have been developed to improve upon the naive approach of checking
for all possible overlaps (which has quadratic complexity in the number of particles <span class="math notranslate nohighlight">\(N\)</span> in the simulation.
In cascade a <a class="reference external" href="https://en.wikipedia.org/wiki/Bounding_volume_hierarchy">Bounding Volume Hierarchy (BVH)</a> is used over the
4D AABB defined over the coordinates  <span class="math notranslate nohighlight">\(x,y,z,r\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Adding the <span class="math notranslate nohighlight">\(r\)</span> coordinate is of great importance to exclude many collisions since orbital
dynamics has a weak radial component.</p>
</div>
</section>
<section id="narrow-phase">
<h1>Narrow Phase<a class="headerlink" href="#narrow-phase" title="Permalink to this headline">#</a></h1>
<p>Hopefully, most collisions have been excluded by now and in the remaining cases cascade resolves collisions
using a computationally more demanding approach: the narrow phase. Assuming the collision between particles <span class="math notranslate nohighlight">\(i, j\)</span>
was not excluded in the broad phase, and since the polynomial expression for the states are anyway available,
cascade computes also the polynomial expressions for the relative distance between the potentially colliding objects:</p>
<div class="math notranslate nohighlight">
\[r_{ij}\left( \tau \right) = \sum_{n=0}^p r_{ij}^{\left[ n \right]}\left( t_0 \right)\tau^n.\]</div>
<p>at this point, to know wether this results in a collision or a miss, cascade only needs to run its clever polynomial
root finding algorithm which excludes efficiently the existence of any root applying
<a class="reference external" href="https://en.wikipedia.org/wiki/Descartes'_rule_of_signs">Descartes rule</a> ,
to only actually compute it in the few remaining cases.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The algorithm description above has been simplified to allow the user to understand the basic ideas and relate them
to cascade behaviour, in particular to the information logged by <a class="reference internal" href="generated/cascade.set_logger_level_trace.html#cascade.set_logger_level_trace" title="cascade.set_logger_level_trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_logger_level_trace()</span></code></a>
and to the choice of the collisional timestep <a class="reference internal" href="generated/cascade.sim.html#cascade.sim.ct" title="cascade.sim.ct"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ct</span></code></a></p>
</div>
</section>
<section id="parallelism">
<h1>Parallelism<a class="headerlink" href="#parallelism" title="Permalink to this headline">#</a></h1>
<p>The main source of parallelism in cascade derives from the execution of parallel collisional timesteps.
The user defines the number of parallel collisional timesteps <a class="reference internal" href="generated/cascade.sim.html#cascade.sim.n_par_ct" title="cascade.sim.n_par_ct"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_par_ct</span></code></a> here denoted with <span class="math notranslate nohighlight">\(N_{c_t}\)</span>.
As a consequence, at each <a class="reference internal" href="generated/cascade.sim.html#cascade.sim.step" title="cascade.sim.step"><code class="xref py py-attr docutils literal notranslate"><span class="pre">step</span></code></a>, cascade builds the piece-wise polyonomial representation of the system state
within a time interval of width <span class="math notranslate nohighlight">\(N_{c_t} \cdot c_t\)</span> rather than only <span class="math notranslate nohighlight">\(c_t\)</span>. This allows to perform the broad and
narrow collision detection in parallel over <span class="math notranslate nohighlight">\(N_{c_t}\)</span> intervals. This strategy reveals to be very effective in situations
where most of the times the step concludes without any collision detected. It can, though, be detrimental in a collision
rich environment as when a collision is detected, all computations that are being performed over
future time intervals have to be discarded.</p>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="generated/cascade.dynamics.mascon_asteroid_energy.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">cascade.dynamics.mascon_asteroid_energy</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="tutorials/quickstart.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Quickstart</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Francesco Biscani and Dario Izzo<br/>
  
      &copy; Copyright 2023, Francesco Biscani and Dario Izzo.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>